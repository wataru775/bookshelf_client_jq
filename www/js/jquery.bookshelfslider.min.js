(function(a){a.bookshelfSlider=function(b,c){function F(){var c=a(b+" #products_box_"+z+" .bs_product:last-child");var d=c.height()+c.offset().top;var f=e.height()+e.offset().top;if(d-143<f){D.css("opacity",.3)}if(d>f){return true}else{return false}}function G(){var c=a(b+" #products_box_"+z+" .bs_product:first-child");var d=c.offset().top;var f=e.offset().top;if(d+143>f){E.css("opacity",.3)}if(d<f){return true}else{return false}}function H(){if(new Date-I<K){setTimeout(H,K)}else{J=false;z=0;B[0]=undefined;a(b+" .slide_animate").css("top",0);a(b+" #btn1").trigger("click")}}if(c){a.extend(a.bookshelfSlider.config,c)}var d=a.bookshelfSlider.config;var e=a(b+" .panel_slider");var f=a(b+" #arrow_menu");var g=a(b+" .slide_animate");var h=a(b+" .button_bar");var i=a(b+" .buttons_container");var j=a(b+" .plugin_dir").text();if(a.browser.msie&&parseInt(a.browser.version)==7){var k=true}if(a.browser.msie&&parseInt(a.browser.version)==8){var l=true}var m=d.slide_duration;var n=d.slide_easing;var o=d.arrow_duration;var p=d.arrow_easing;var q=d.show_title_in_popup;var r=d.video_width_height;var s=d.iframe_width_height;e.width(d.item_width);e.height(d.item_height);g.width(e.width());g.height(d.item_height+5e3);h.css("margin-left",d.buttons_margin);if(!k){switch(d.buttons_align){case"left":i.css("float","left");break;case"center":var t=0;a(b+" .button_bar").each(function(){t+=a(this).width()+d.buttons_margin});t+=20;var u=parseInt(t/e.width()*100);i.css("width",u+"%");break;case"right":i.css("float","right");i.css("margin-right",d.buttons_margin);break}}a(b+" .panel_bar").width(d.item_width);a(b+" .panel_title").width(d.item_width);a(b+" .bs_product").css("margin-right",d.product_margin);var v=parseInt(h.css("margin-left"));var w=a(b+" #btn1").position().left+v+a(b+" #btn1").width()/2-10;f.css("left",w);f.show();a(b+" .panel_items").css("width","99999");if(d.show_selected_title){a(b+" .selected_title_box").show();a(b+" .selected_title").text(a(b+" #btn1").text())}a(b+" .products_box").css("margin-left",d.products_box_margin_left);a(b+" .bs_product").each(function(c){var e=a(this);if(e.attr("title")!=""&&e.attr("title")!="undefined"){var f=true}else{var f=false}var g=e.children("img");var h=e.children("img").attr("height");var i=e.children("img").attr("width");c++;if(f&&d.product_show_title){e.append("<div class='bs_product_title' id='title_"+c+"'>"+e.attr("title")+"</div>");var k=a(b+" #title_"+c);var l=h-a(k).height()/2;k.css({left:(e.width()-k.width()-9)/2,top:l});k.css({color:d.product_title_textcolor,background:d.product_title_bgcolor+" url("+j+"assets/title_product_bg.png) repeat"})}e.mouseenter(function(){a(k).css({overflow:"visible","max-height":150});a(b+" #i_zoom_"+c).css({"background-position":"-24px 0"});a(b+" #i_play_"+c).css({"background-position":"-72px 0"});a(b+" #i_link_"+c).css({"background-position":"-120px 0"});a(b+" #i_iframe_"+c).css({"background-position":"-168px 0"})}).mouseleave(function(){a(k).css({overflow:"hidden","max-height":11});a(b+" #i_zoom_"+c).css({"background-position":"0 0"});a(b+" #i_play_"+c).css({"background-position":"-48px 0"});a(b+" #i_link_"+c).css({"background-position":"-96px 0"});a(b+" #i_iframe_"+c).css({"background-position":"-144px 0"})});e.children("img").addClass("img_thumb");var m=e.attr("data-type");if(m=="book"){e.append("<img class='fx_book' id='b_"+c+"' + src='"+j+"assets/book_fx.png' />");a(b+" #b_"+c).css({height:h,top:e.height()-h})}else if(m=="magazine"){e.append("<img class='fx_magazine' id='m_"+c+"' + src='"+j+"assets/magazine_fx.png' />");a(b+" #m_"+c).css({height:h,top:e.height()-h})}else if(m=="cd"){e.append("<img class='fx_cd' id='cd_"+c+"' + src='"+j+"assets/cd_fx.png' />");a(b+" #cd_"+c).css({height:h,top:e.height()-h})}else if(m=="dvd"){e.append("<img class='fx_cd' id='dvd_"+c+"' + src='"+j+"assets/dvd_fx.png' />");a(b+" #dvd_"+c).css({height:h,top:e.height()-h})}e.append("<img class='fx_shadow' id='shd_"+c+"' + src='"+j+"assets/shadow_fx.png' />");if(d.show_icons){var n=e.attr("data-url");var o=e.attr("data-popup");if(n!=undefined){if(o=="true"&&(n.indexOf(".jpg")!=-1||n.indexOf(".gif")!=-1||n.indexOf(".png")!=-1)){e.append("<div class='icons_sprite' id='i_zoom_"+c+"'></div>");var p=a(b+" #i_zoom_"+c);p.css({"background-position":"0 0",left:(g.width()-p.width())/2,top:e.height()-h/2-p.height()/2,opacity:1})}else if(o=="true"&&(n.indexOf("youtube.com")!=-1||n.indexOf("vimeo.com")!=-1)){e.append("<div class='icons_sprite' id='i_play_"+c+"'></div>");var q=a(b+" #i_play_"+c);q.css({"background-position":"-48px 0",left:(g.width()-q.width())/2,top:e.height()-h/2-q.height()/2,opacity:1})}else if(o=="true"&&n!=""&&n!=undefined){e.append("<div class='icons_sprite' id='i_iframe_"+c+"'></div>");var r=a(b+" #i_iframe_"+c);r.css({"background-position":"-144px 0",left:(g.width()-r.width())/2,top:e.height()-h/2-r.height()/2,opacity:1})}else if(n!=""&&n!=undefined){e.append("<div class='icons_sprite' id='i_link_"+c+"'></div>");var s=a(b+" #i_link_"+c);s.css({"background-position":"-96px 0",left:(g.width()-s.width())/2,top:e.height()-h/2-s.height()/2,opacity:1})}}}g.css({width:i,height:h});if(e.height()!=h){var t=e.height()-h;g.css("top",t);a(b+" #shd_"+c).css({height:h,left:g.width(),top:t});if(f&&d.product_show_title){a(k).css("top",e.height()-a(k).height()/2)}}});var x=0;var y=0;h.click(function(c){c.preventDefault();var e=a(this);if(z-1==e.index())return false;if(parseInt(g.css("top"))!=0){g.animate({top:0,opacity:1},{duration:300})}var h=e.attr("id");var i=a(b+" #"+h);var j=i.position();var k=i.width();var l=j.left+v+k/2-10;f.animate({left:l},{duration:o,easing:p,complete:function(){if(d.show_selected_title)a(b+" .selected_title").text(i.text())}});y=parseInt(a(b+" .panel_slider").css("width"))*e.index();x=-y;g.animate({left:x,top:0},{duration:m,easing:n,complete:function(){}});A=0;D.css("opacity",.3);E.css("opacity",.3);z=e.index()+1;if(B[0]==undefined){a(g).each(function(a){B[a]=F();z++});z=e.index()+1}if(B[e.index()]){D.css("opacity",1);C.show();C.fadeTo("normal",1);a(b+" .panel_slider").mouseenter(function(){C.show();C.fadeTo("normal",1)}).mouseleave(function(){C.hide()})}else{C.hide()}});var z=0;var A=0;var B=[];a(b+" .panel_slider").append("<div id='more_minus_box'><input type='button' id='icon_minus' /><input type='button' id='icon_more' /></div>");var C=a(b+" #more_minus_box");var D=a(b+" #icon_more");var E=a(b+" #icon_minus");E.click(function(b){if(E.css("opacity")!=1)return;a(this).attr("disabled","disabled");var c=G();if(!c){return}A-=143;D.css("opacity",1);g.animate({left:x,top:-A},{duration:m/2,easing:n,complete:function(){E.removeAttr("disabled")}})});D.click(function(b){if(D.css("opacity")!=1)return;a(this).attr("disabled","disabled");var c=F();if(!c){return}A+=143;E.css("opacity",1);g.animate({left:x,top:-A},{duration:m/2,easing:n,complete:function(){D.removeAttr("disabled")}})});a(b+" .show_hide_titles").click(function(c){c.preventDefault();if(a(b+" .bs_product_title").css("opacity")==1){a(b+" .bs_product_title").stop().animate({opacity:0},400);a(this).css({opacity:.5})}else{a(b+" .bs_product_title").stop().animate({opacity:1},400);a(this).css({opacity:1})}});a(b+" .show_hide_icons").click(function(c){c.preventDefault();if(a(b+" .icons_sprite").css("opacity")==1){a(b+" .icons_sprite").stop().animate({opacity:0},400);a(this).css({opacity:.5})}else{a(b+" .icons_sprite").stop().animate({opacity:1},400);a(this).css({opacity:1})}});a(b+" .bs_product").click(function(b){function E(b,c,d,e){if(b>i){b=i-80}var f=a("#popup_info");f.delay(100).animate({top:m/2-f.height()/2,left:i/2-f.width()/2},400,function(){a("#preload_icon").remove()});var g=i/2-b/2;var h=m/2-c/2;f.delay(100).animate({height:c,width:b,top:h,left:g-15},400,function(){f.append(d);a(d).fadeIn(600);if(a(e).attr("title")!=""&&a(e).attr("title")!="undefined"&&q){var c=a(e).attr("title");f.append("<div id='bs_popup_title'><div id='bs_close_button'></div>"+c+"</div>");var g=parseInt(f.css("padding-left"));a("#bs_popup_title").css({width:b+g,top:-(g*2)-2,left:0});a("#bs_popup_title").fadeIn(400);a("#bs_popup_title").fadeTo("normal",1);a("#bs_close_button").click(function(){a("#mask_popup").hide();a("#mask_popup").remove();a("#popup_info").remove()})}if(e.children(".bs_product_description").length>0){var h=e.children(".bs_product_description").html();if(k){f.children("#iframe_content").load(function(){a(this.contentWindow.document).find("body").append(h)})}else{f.children("#iframe_content").load(function(){a(this.contentDocument).find("body").append(h)})}}})}b.preventDefault();var c=a(this);var d=c.attr("data-url");var e=c.attr("data-popup");var f=c.attr("data-newwindow");if(e!="true"){if(f!="true"){if(d==undefined||d==""){return}else{window.open(d,"_self");return}}else{if(d==undefined||d==""){return}else{window.open(d,"_blank");return}}}if(e=="true"&&(d==undefined||d==""))return;a("body").append('<div id="mask_popup"></div>');a("body").append('<div id="popup_info"></div>');a("#popup_info").append("<img id='preload_icon' src='"+j+"assets/preload.gif' />");var g=a("#mask_popup");var h=a("#popup_info");var i=a(window).width();var m=a(window).height();var n=a(document).height();g.css({width:i,height:n});g.fadeIn(400);g.fadeTo("normal",.7);h.css({top:m/2-h.height()/2,left:i/2-h.width()/2});var o=d.indexOf(".jpg")!=-1||d.indexOf(".gif")!=-1||d.indexOf(".png")!=-1?true:false;var p=d.indexOf("youtube.com")!=-1?true:false;var t=d.indexOf("vimeo.com")!=-1?true:false;var u=d.indexOf(".jpg")==-1&&d.indexOf(".gif")==-1&&d.indexOf(".png")==-1&&!t&&!p?true:false;if(o){var v=c;if(k||l){var w=a("<img />").attr("src",d+"?"+(new Date).getTime())}else{var w=a("<img />").attr("src",d)}w.load(function(){var b=this.width;var c=this.height;if(this.width>i){var d=i-80;var e=this.width;var f=d/e*100;this.height=f/100*this.height;this.width=d}E(this.width,this.height,w,v);a(w).hide()})}else if(p){if(r[0]>i){r[0]=i-80}var x=d.split("?v=");var y="?autohide=2&autoplay=1&controls=1&disablekb=0&fs=1&hd=0&loop=0&rel=1&showinfo=0&showsearch=1&wmode=transparent&enablejsapi=1";var z='<iframe class="video_player" width="'+r[0]+'" height="'+r[1]+'" frameborder="0" src="http://www.youtube.com/embed/'+x[1]+y+'"></iframe>';E(r[0],r[1],z,c)}else if(t){if(r[0]>i){r[0]=i-80}var x=d.split("/").pop();var z='<iframe class="video_player" src="http://player.vimeo.com/video/'+x+'?title=0&byline=0&portrait=0&autoplay=1" width="'+r[0]+'" height="'+r[1]+'" frameborder="0"></iframe>';E(r[0],r[1],z,c)}else if(u){if(d.indexOf("?size=")!=-1){var A=d.split("?size=").pop().split("&");var B=A[0].split("x");var C=parseInt(B[0]),D=parseInt(B[1])}else{var C=s[0],D=s[1]}if(C>i){C=i-80}if(d.indexOf("[#description#]")!=-1){var z='<iframe id="iframe_content" src="'+j+'content/blank.php" width="'+C+'" height="'+D+'" frameborder="0"></iframe>'}else{var z='<iframe id="iframe_content" src="'+d+'" width="'+C+'" height="'+D+'" frameborder="0"></iframe>'}E(C,D,z,c)}a("#mask_popup").click(function(){a(this).hide();a(this).remove();a("#popup_info").remove()})});a(b+" #btn1").trigger("click");var I=new Date(1,1,2e3,12,0,0);var J=false;var K=200;a(window).resize(function(){I=new Date;if(J===false){J=true;setTimeout(H,K)}if(a(b).width()>a(window).width()){a(b).width(a(window).width());a(b+" .slide_animate").width(a(b+" .panel_slider").width());var c=a(b+" .panel_slider").width()*(z-1);a(b+" .slide_animate").css("left",-c)}if(a(b).width()+100<a(window).width()){a(b).width("100%");a(b+" .slide_animate").width(a(b+" .panel_slider").width());var c=a(b+" .panel_slider").width()*(z-1);a(b+" .slide_animate").css("left",-c)}if(a(b).width()>a("#popup_info").width()){var d=a("#popup_info");var e=a(window).width();var f=a(window).height();var g=a(document).height();d.css({top:f/2-d.height()/2,left:e/2-d.width()/2});var h=a("#mask_popup");h.css({width:e,height:f})}});return this};a.bookshelfSlider.config={item_width:355,item_height:320,products_box_margin_left:20,product_title_textcolor:"#ffffff",product_title_bgcolor:"#c33b4e",product_margin:30,product_show_title:true,show_title_in_popup:true,show_selected_title:true,show_icons:true,buttons_margin:10,buttons_align:"center",slide_duration:1e3,slide_easing:"easeInOutExpo",arrow_duration:800,arrow_easing:"easeInOutExpo",video_width_height:[500,290],iframe_width_height:[400,300]}})(jQuery)
